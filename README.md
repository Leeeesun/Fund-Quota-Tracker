# Fund Limit Monitor (基金申购限额监控)

本项目是一个功能强大的基金监控工具，专注于自动追踪 QDII 基金（如纳斯达克 100、标普 500 等）的单日申购限额变化。它能自动更新监控名单，并每天为您发送一份排版精美、带有涨跌对比的 HTML 数据报表。

## 🌟 核心特性

- **专业报表**：发送响应式 HTML 邮件，采用现代化表格布局，支持手机端完美阅读。
- **变动追踪**：自动对比前一交易日数据，用 **绿色 ↑** 或 **红色 ↓** 直观展示限额提升或缩减。
- **智能过滤**：自动识别基金类型，将纳指、标普 500 及其他类目分门别类展示。
- **全自动维护**：集成 `akshare` 接口，每月自动扫描全市场，更新标普 500 和纳指相关的新发/存量基金监控列表。
- **高可靠性**：内置 3 次重试机制、30 秒超时控制以及随机 User-Agent，确保在 GitHub Actions 环境下稳定运行。
- **双通知通道**：首选精美邮件推送，同时兼容企业微信机器人（Markdown 格式）。

## 📂 项目结构

```text
.
├── monitor.py           # 主监控程序：数据爬取、报表生成及发送
├── update_funds.py      # 自动更新脚本：使用 akshare 维护监控名单
├── config.json          # 配置文件：存储 API 配置及基金名单（自动维护）
├── history.json         # 状态管理：存储昨日限额用于对比变化
├── requirements.txt     # 项目依赖
└── .github/workflows/   # 自动化流程 (每日监控 + 每月更新)
```

## 🚀 快速开始

### 1. 自动化部署 (推荐)

直接在 GitHub 仓库中配置以下 **Secrets**，即可实现每日定时运行：

| Secret 名称 | 说明 | 示例 |
| :--- | :--- | :--- |
| `EMAIL_SENDER` | 发信人邮箱地址 | `invest_monitor@qq.com` |
| `EMAIL_PASSWORD` | SMTP 授权码 (非登录密码) | `abcd1234efgh5678` |
| `SMTP_SERVER` | SMTP 服务器地址 | `smtp.qq.com` |
| `SMTP_PORT` | SMTP 端口 (通常为 465 或 587) | `465` |
| `EMAIL_RECEIVER` | 收件人邮箱 (支持多个，逗号分隔) | `my@me.com, user@work.com` |

> [!TIP]
> **GitHub Actions 调度：**
> - **每日日报**：北京时间 13:30 自动发送监控报表。
> - **每月更新**：每月 1 号自动同步天天基金网最新的监控名单。

### 2. 本地开发与测试

```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 定时更新监控列表 (可选)
python update_funds.py

# 3. 运行监控并查看输出
python monitor.py
```

## 📊 邮件预览

邮件包含以下信息：
- **基金名称 & 代码**：清晰标识目标基金。
- **当前状态**：实时显示“开放”、“暂停”等交易状态。
- **今日限额**：精准展示当日最高申购金额。
- **较上日变化**：直观展示限额增加（↑）、减少（↓）或稳定（-）。

## ⚠️ 注意事项

1. **数据来源**：数据抓取自天天基金网公开页面，仅供个人学习和交流使用，请勿用于商业用途。
2. **抓取频率**：GitHub Actions 的调度频率已优化，请避免在本地高频循环运行，以免 IP 被暂时屏蔽。
3. **隐私安全**：请务必使用 GitHub Secrets 存储敏感配置，切勿在 `config.json` 中明文记录密码。

---
*Created with ❤️ for smart investors.*
